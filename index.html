<script>
    async function verifyIP() {
        let recaptchaResponse = grecaptcha.getResponse();
        if (!recaptchaResponse) {
            alert("Please complete the CAPTCHA.");
            return;
        }

        let ipResponse = await fetch("https://api64.ipify.org?format=json");
        let ipData = await ipResponse.json();
        let userIP = ipData.ip;

        // Get chat_id from URL parameters
        let urlParams = new URLSearchParams(window.location.search);
        let chatID = urlParams.get("chat_id");

        if (!chatID) {
            alert("Error: Unable to get user chat ID. Please try again.");
            return;
        }

        // Send verification message to the user
        let botWebhookURL = "https://api.telegram.org/bot7794715173:AAG15t57fuBmddv_e0aJqAyfdIXaoXuk0lM/sendMessage";
        let messageText = "âœ… Verification successful! Please restart the bot to continue using it.";
        let finalURL = `${botWebhookURL}?chat_id=${chatID}&text=${encodeURIComponent(messageText)}`;

        // Redirect user back to bot after verification
        window.location.href = finalURL;
    }
</script>
